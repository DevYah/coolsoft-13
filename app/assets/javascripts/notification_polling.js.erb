// initiates the polling if there is a signed in user.
// Params: none
// Author: Amina Zoheir
$(function() {
  if($('body').attr('data-devise') == "true"){
    if($("#notifications").length > 0){
      setTimeout(updateNotifications, 5000);
    }
    setTimeout(updateNavBar, 5000);
  }
});

// updates the notifications in the "view_all_notifications" view,
// and continues the polling.
// Params: none
// Author: Amina Zoheir
function updateNotifications(){
  var after = $('.notification:first').attr('data-time');
  $.getScript("/new_notifications.js?&after=" + after);
  setTimeout(updateNotifications, 5000);
}

// updates the notifications in the navigation bar drop down,
// and continues the polling.
// Params: none
// Author: Amina Zoheir
function updateNavBar(){
  $.getScript("/notifications")
  setTimeout(updateNavBar, 5000);
}
